apiVersion: v1
data:
  prismCentral: |-
    {
      "address": "{{ .Values.pc }}",
      "port": 9440,
      "insecure": true,
      "credentialRef": {
        "kind": "secret",
        "name": "nutanix-creds"
      },
      "additionalTrustBundle": {
        "kind": "ConfigMap",
        "name": "nutanix-trustbundle"
      }
    }
kind: ConfigMap
metadata:
  name: nutanix-endpoint
  namespace: {{ .Release.Namespace }}
---
apiVersion: v1
binaryData:
  ca.crt: ""
kind: ConfigMap
metadata:
  name: nutanix-trustbundle
  namespace: {{ .Release.Namespace }}
---
apiVersion: v1
kind: Secret
type: Opaque
metadata:
  name: nutanix-creds
  namespace: {{ .Release.Namespace }}
stringData:
  credentials: |
    [
      {
        "type": "basic_auth", 
        "data": { 
          "prismCentral":{
            "username": "{{ .Values.username }}",
            "password": "{{ .Values.password }}"
          },
          "prismElements": null
        }
      }
    ]
